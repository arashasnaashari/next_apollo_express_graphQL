<!DOCTYPE html>
<html>
  <head>
    <style>
      canvas {
        margin: 20px;
        transform: rotateY('40deg');
      }
    </style>
  </head>
  <body>
    <input type="file" id="input" />
    <br />

    <br />canvas:<br />
    <canvas id="canvas" width="64" height="64"></canvas>

    <br />output:<br />
    <textarea id="file_output"></textarea>
    <script>
      var canvas = document.getElementById("canvas");
      var ctx = canvas.getContext("2d");
      var cw = canvas.width;
      var ch = canvas.height;
      var maxW = 120;
      var maxH = 120;

      var input = document.getElementById("input");
      var output = document.getElementById("file_output");
      input.addEventListener("change", handleFiles);

      function handleFiles(e) {
        var img = new Image();
        img.onload = function () {
          var iw = img.width;
          var ih = img.height;
          var scale = Math.min(maxW / iw, maxH / ih);
          var iwScaled = iw * scale;
          var ihScaled = ih * scale;
          canvas.width = iwScaled;
          canvas.height = ihScaled;
          ctx.drawImage(img, 0, 0, iwScaled, ihScaled);
          output.value = canvas.toDataURL("image/jpeg", 0.8);
        };
        img.src = URL.createObjectURL(e.target.files[0]);
      }
    </script>
  </body>
</html>
